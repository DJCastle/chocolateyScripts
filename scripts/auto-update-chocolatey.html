<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Auto-Update Chocolatey - Chocolatey Scripts</title>
  <meta name="description" content="Automatically update Chocolatey and all installed packages with conditional safety checks, email notifications, and retry logic.">
  <meta name="keywords" content="chocolatey, auto update, windows automation, powershell, package updates, scheduled updates, email notifications">
  <meta name="author" content="CodeCraftedApps">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://chocolateyscripts.codecraftedapps.com/scripts/auto-update-chocolatey.html">
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Auto-Update Chocolatey - Chocolatey Scripts">
  <meta property="og:description" content="Automatically update Chocolatey and all installed packages with conditional safety checks, email notifications, and retry logic.">
  <meta property="og:url" content="https://chocolateyscripts.codecraftedapps.com/scripts/auto-update-chocolatey.html">
  <meta property="og:site_name" content="Chocolatey Scripts">
  <meta property="og:image" content="https://chocolateyscripts.codecraftedapps.com/favicon.png">
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Auto-Update Chocolatey - Chocolatey Scripts">
  <meta name="twitter:description" content="Automatically update Chocolatey and all installed packages with conditional safety checks, email notifications, and retry logic.">
  <meta name="twitter:image" content="https://chocolateyscripts.codecraftedapps.com/favicon.png">
  <meta name="theme-color" content="#0a0e14">
  <meta name="color-scheme" content="dark">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="../favicon.png">
  <link rel="apple-touch-icon" href="../apple-touch-icon.png">
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <a href="#main" class="skip-link">Skip to content</a>

  <header class="site-header">
    <div class="container">
      <a href="../index.html" class="site-logo">Chocolatey<span>Scripts</span></a>
      <button class="nav-toggle" aria-label="Toggle navigation menu">&#9776;</button>
      <nav class="site-nav" aria-label="Main navigation">
        <a href="../index.html">Home</a>
        <a href="../getting-started.html">Getting Started</a>
        <a href="../guides.html">Guides</a>
        <a href="../scripts.html" class="active">Scripts</a>
        <a href="../faq.html">FAQ</a>
        <a href="../about.html">About</a>
      </nav>
    </div>
  </header>

  <main id="main">
    <nav class="breadcrumbs container" aria-label="Breadcrumb">
      <a href="../index.html">Home</a><span class="separator">/</span><a href="../scripts.html">Scripts</a><span class="separator">/</span>Auto-Update Chocolatey
    </nav>

    <div class="page-header">
      <div class="container">
        <h1>Auto-Update Chocolatey</h1>
        <p>Automatically update Chocolatey and all installed packages with conditional safety checks.</p>
        <div class="script-meta">
          <span class="script-meta-item">auto-update-chocolatey.ps1</span>
          <span class="script-meta-item">Maintenance</span>
          <span class="script-meta-item">Windows 10/11</span>
        </div>
        <div class="script-actions">
          <a href="https://raw.githubusercontent.com/DJCastle/chocolateyScripts/main/auto-update-chocolatey.ps1" class="btn-primary" target="_blank" rel="noopener noreferrer">Download Script</a>
          <a href="https://github.com/DJCastle/chocolateyScripts/blob/main/auto-update-chocolatey.ps1" class="btn-secondary" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
      </div>
    </div>

    <section class="content-section">
      <div class="container">
        <div class="content-body">

          <h2>What This Script Does</h2>

          <p>The <code>auto-update-chocolatey.ps1</code> script is the most sophisticated and feature-rich script in the Chocolatey Scripts toolkit. It provides a fully automated, intelligent update system that keeps your Chocolatey installation and all managed packages up to date while incorporating multiple layers of safety checks to ensure updates only run under appropriate conditions. This script is designed to be executed unattended, typically through a Windows Scheduled Task, making it the centerpiece of a hands-free maintenance strategy for your Windows software.</p>

          <p>Before attempting any updates, the script performs a series of conditional checks to verify that the environment is suitable for running package updates. The first and most important of these checks is the WiFi network verification. The script compares the currently connected wireless network against a configured network name stored in <code>config.json</code>. This check prevents the script from downloading potentially large package updates over metered connections, mobile hotspots, or unfamiliar networks. If the current WiFi network does not match the configured name, the script logs the mismatch and exits gracefully without performing any updates.</p>

          <p>The second conditional check verifies that the computer is connected to AC power rather than running on battery. This is particularly important for laptop users who might have the script scheduled to run overnight. Package updates can be resource-intensive, involving downloads, installations, and system modifications that consume significant CPU cycles and disk I/O. Running these operations on battery power could drain the battery unexpectedly or cause the system to shut down mid-update, potentially leaving packages in a corrupted state. The power check queries the Windows Management Instrumentation (WMI) subsystem to determine the current power source, and if the machine is running on battery, the script defers the update to the next scheduled run.</p>

          <p>The third conditional check confirms that the script is running with Administrator privileges. While this may seem redundant for a scheduled task that should already be configured to run elevated, the check serves as a safety net. Chocolatey package installations and updates require administrator access to modify program files, registry entries, and system PATH variables. If the script somehow runs without elevation, it will fail gracefully with a clear log message rather than producing confusing permission-denied errors partway through the update process.</p>

          <p>Once all conditional checks pass, the script proceeds to the update phase, which operates in three distinct stages. The first stage updates the Chocolatey package manager itself by running <code>choco upgrade chocolatey</code>. Keeping Chocolatey up to date is important because newer versions include bug fixes, performance improvements, and enhanced package handling capabilities. The second stage runs <code>choco upgrade all</code> to update every installed package to its latest available version. The third stage performs a cleanup of obsolete package versions and cached downloads to reclaim disk space and keep the Chocolatey installation tidy.</p>

          <p>The update process incorporates retry logic to handle transient network failures gracefully. If a package download fails due to a network timeout or server error, the script does not immediately give up. Instead, it waits for a configurable delay period and then retries the failed operation. The maximum number of retry attempts and the delay between retries are both configurable through <code>config.json</code>. This retry mechanism is particularly valuable for scheduled tasks that run during off-hours when network equipment might be restarting or when internet service providers perform maintenance.</p>

          <p>Email notification support is one of the standout features of this script. After the update process completes, whether successfully or with errors, the script can send a detailed email report to a configured address. This email includes a summary of which packages were updated, which failed, the total execution time, and any warnings or errors that occurred during the process. The email configuration supports SMTP server settings with configurable port numbers, allowing it to work with a variety of email providers and corporate mail servers. For users who prefer not to receive emails, the notification system can be disabled through <code>config.json</code>.</p>

          <p>In addition to email notifications, the script integrates with the <code>Send-ToastNotification.ps1</code> helper function to display Windows toast notifications. These pop-up notifications provide immediate visual feedback when the script runs interactively or when a user is logged in during a scheduled execution. The toast notifications display a brief summary of the update results, including the number of packages updated and whether any errors occurred. This dual notification approach ensures you stay informed about the state of your system regardless of whether you are actively monitoring the machine.</p>

          <p>All operations performed by this script are logged in detail to <code>%USERPROFILE%\Logs\AutoUpdateChocolatey.log</code>. The log file captures the results of every conditional check, each package update attempt including retry attempts, the email notification status, and the overall execution summary. The log uses a timestamped format that makes it easy to correlate events and diagnose issues. Over time, these logs provide a complete history of your system's update activity, which is useful for troubleshooting problems or auditing software changes.</p>

          <p>The script loads all of its configuration from a <code>config.json</code> file located in the same directory as the script. This centralized configuration approach means you can customize the behavior of the auto-update process without modifying the script itself. This separation of configuration from code is a deliberate design choice that makes it safe to update the script from the repository without losing your personal settings. The configuration file is validated at startup, and if any required values are missing or invalid, the script logs a helpful error message identifying exactly which configuration keys need attention.</p>

          <h2>Usage</h2>

          <p>The script can be run manually or through a scheduled task. Manual execution requires an elevated PowerShell window.</p>

          <pre><code># Run manually from the scripts directory
.\auto-update-chocolatey.ps1</code></pre>

          <p>For automated execution, use the <code>setup-scheduled-tasks.ps1</code> script to create a Windows Scheduled Task, or create one manually:</p>

          <pre><code># Example: Create a scheduled task to run every Sunday at 3:00 AM
$action = New-ScheduledTaskAction -Execute "powershell.exe" `
    -Argument "-ExecutionPolicy Bypass -File C:\path\to\auto-update-chocolatey.ps1"
$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Sunday -At 3am
Register-ScheduledTask -TaskName "ChocolateyAutoUpdate" `
    -Action $action -Trigger $trigger -RunLevel Highest</code></pre>

          <h2>Configuration</h2>

          <p>The script reads its settings from <code>config.json</code> in the script directory. Below are all available configuration options.</p>

          <table>
            <thead>
              <tr>
                <th>Key</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr><td><code>wifiNetwork</code></td><td>String</td><td>The SSID of the WiFi network required for updates to proceed. Set to an empty string to skip this check.</td></tr>
              <tr><td><code>emailAddress</code></td><td>String</td><td>The email address to receive update reports. Leave empty to disable email notifications.</td></tr>
              <tr><td><code>smtpServer</code></td><td>String</td><td>The SMTP server hostname for sending email notifications (e.g., <code>smtp.gmail.com</code>).</td></tr>
              <tr><td><code>smtpPort</code></td><td>Integer</td><td>The SMTP server port number (e.g., <code>587</code> for TLS, <code>465</code> for SSL).</td></tr>
              <tr><td><code>maxRetries</code></td><td>Integer</td><td>Maximum number of retry attempts for failed package operations. Default: <code>3</code>.</td></tr>
              <tr><td><code>retryDelaySeconds</code></td><td>Integer</td><td>Seconds to wait between retry attempts. Default: <code>30</code>.</td></tr>
              <tr><td><code>notifications.email</code></td><td>Boolean</td><td>Enable or disable email notification reports. Default: <code>true</code>.</td></tr>
              <tr><td><code>notifications.toast</code></td><td>Boolean</td><td>Enable or disable Windows toast notifications. Default: <code>true</code>.</td></tr>
            </tbody>
          </table>

          <p>Example <code>config.json</code>:</p>

          <pre><code>{
    "wifiNetwork": "MyHomeNetwork",
    "emailAddress": "you@example.com",
    "smtpServer": "smtp.gmail.com",
    "smtpPort": 587,
    "maxRetries": 3,
    "retryDelaySeconds": 30,
    "notifications": {
        "email": true,
        "toast": true
    }
}</code></pre>

          <h2>What Gets Changed</h2>

          <ul>
            <li><strong>Chocolatey upgrade</strong> &mdash; Updates the Chocolatey package manager itself to the latest version.</li>
            <li><strong>Package upgrades</strong> &mdash; Updates all installed Chocolatey packages to their latest available versions.</li>
            <li><strong>Cache cleanup</strong> &mdash; Removes old package versions and cached downloads after updates complete.</li>
            <li><strong>Log file</strong> &mdash; Creates or appends to <code>%USERPROFILE%\Logs\AutoUpdateChocolatey.log</code>.</li>
            <li><strong>Email notification</strong> &mdash; Sends an update report to the configured email address (if enabled).</li>
            <li><strong>Toast notification</strong> &mdash; Displays a Windows notification with the update summary (if enabled).</li>
          </ul>

          <h2>Related Scripts</h2>

          <div class="hub-grid">
            <a href="setup-scheduled-tasks.html" class="hub-card">
              <h3>Scheduled Tasks Setup</h3>
              <p>Set up Windows scheduled tasks to run auto-update automatically on a schedule.</p>
            </a>
            <a href="cleanup-chocolatey.html" class="hub-card">
              <h3>Chocolatey Cleanup</h3>
              <p>Run a deeper cleanup of old package versions, caches, and temporary files.</p>
            </a>
            <a href="send-toast-notification.html" class="hub-card">
              <h3>Toast Notifications</h3>
              <p>The helper function used by auto-update to display Windows notifications.</p>
            </a>
          </div>

        </div>
      </div>
    </section>

  </main>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-brand">
          <a href="../index.html" class="site-logo">Chocolatey<span>Scripts</span></a>
          <p class="footer-tagline">Chocolatey packages and scripts for automated software management on Windows.</p>
        </div>
        <div class="footer-column">
          <h4>Resources</h4>
          <a href="../getting-started.html">Getting Started</a>
          <a href="../guides.html">Guides</a>
          <a href="../scripts.html">Scripts</a>
          <a href="../faq.html">FAQ</a>
        </div>
        <div class="footer-column">
          <h4>Project</h4>
          <a href="../about.html">About</a>
          <a href="../contact.html">Contact</a>
          <a href="../privacy.html">Privacy Policy</a>
          <a href="../terms.html">Terms of Service</a>
          <a href="https://github.com/DJCastle/chocolateyScripts" target="_blank" rel="noopener noreferrer">GitHub</a>
          <a href="https://codecraftedapps.com" target="_blank" rel="noopener noreferrer">CodeCraftedApps</a>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2026 CodeCraftedApps. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <button class="back-to-top" aria-label="Back to top">&uarr;</button>

  <script>
  (function() {
    var toggle = document.querySelector('.nav-toggle');
    var nav = document.querySelector('.site-nav');
    toggle.addEventListener('click', function(e) {
      e.stopPropagation();
      nav.classList.toggle('open');
    });
    document.addEventListener('click', function(e) {
      if (!nav.contains(e.target) && !toggle.contains(e.target)) {
        nav.classList.remove('open');
      }
    });

    var reveals = document.querySelectorAll('.reveal');
    if (reveals.length) {
      var observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1 });
      reveals.forEach(function(el) { observer.observe(el); });
    }

    var backToTop = document.querySelector('.back-to-top');
    if (backToTop) {
      window.addEventListener('scroll', function() {
        if (window.scrollY > 300) {
          backToTop.classList.add('visible');
        } else {
          backToTop.classList.remove('visible');
        }
      });
      backToTop.addEventListener('click', function() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    }
  })();
  </script>

  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="codecraftopensource" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting and for your support." data-color="#5C9FD8" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</body>
</html>
